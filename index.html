<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Hair Try-On</title>
<style>
    body{font-family:Arial;background:#111;color:white;text-align:center}
    #log{border:1px solid #444;padding:10px;height:140px;width:90%;margin:auto;overflow:auto;background:#000;}
    .preview{max-width:240px;border:2px solid #555;margin:5px}
</style>
</head>
<body>

<h2>AI Hairstyle Preview</h2>

<select id="gender">
  <option value="male">Male</option>
  <option value="female">Female</option>
</select>

<br><br>

<input type="file" id="fileInput" accept="image/*">

<br><br>

<button id="runBtn" disabled>Apply Hair</button>

<div>
    <p>Your Image:</p>
    <img id="facePreview" class="preview">
</div>

<div>
    <p>Result:</p>
    <canvas id="resultCanvas" width="300" height="300" style="background:#222"></canvas>
</div>

<h3>Status Logs</h3>
<div id="log"></div>

<script>
// ------------ HAIR TEMPLATE IMAGES -------------
const hairImages = {
  male:[
    "https://i.ibb.co/7XVy3Vt/m1.png",
    "https://i.ibb.co/8YX0RMm/m2.png",
    "https://i.ibb.co/DVtRW6V/m3.png"
  ],
  female:[
    "https://i.ibb.co/0BLLpMN/f1.png",
    "https://i.ibb.co/2nPWn1g/f2.png",
    "https://i.ibb.co/s6VrTm5/f3.png"
  ]
};

let faceImg = null;
let modelLoaded = false;

// -------- Logging helper ----------
function log(msg){
  document.getElementById("log").innerHTML += msg+"<br>";
  console.log(msg);
}

// -------- Fake model init ----------
function initModel(){
  log("Loading hairstyle model...");
  setTimeout(()=>{
     modelLoaded = true;
     document.getElementById("runBtn").disabled = false;
     log("Model READY ✔");
  },1500);
}
initModel();

// ---------- Image Upload -----------
document.getElementById("fileInput").addEventListener("change",function(e){
  const file = e.target.files[0];
  if(!file){return;}
  const reader=new FileReader();
  reader.onload=function(ev){
    faceImg=new Image();
    faceImg.src=ev.target.result;
    faceImg.onload=function(){
       document.getElementById("facePreview").src=faceImg.src;
       log("User image loaded");
    }
  }
  reader.readAsDataURL(file);
});

// ---------- Apply Hair Button ------
document.getElementById("runBtn").addEventListener("click",function(){
  if(!modelLoaded){log("❌ Model not loaded");return;}
  if(!faceImg){log("❌ No image selected");return;}

  log("Processing started...");

  const g=document.getElementById("gender").value;
  const hairUrl=hairImages[g][Math.floor(Math.random()*hairImages[g].length)];

  const hair=new Image();
  hair.src=hairUrl;
  hair.onload=function(){
     const c=document.getElementById("resultCanvas").getContext("2d");
     c.clearRect(0,0,300,300);
     c.drawImage(faceImg,0,0,300,300);
     c.drawImage(hair,0,0,300,300);
     log("Done ✔");
  }
});
</script>

</body>
</html>
